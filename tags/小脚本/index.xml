<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>小脚本 on My New Hugo Site</title>
    <link>https://cywd123.github.io/tags/%E5%B0%8F%E8%84%9A%E6%9C%AC/</link>
    <description>Recent content in 小脚本 on My New Hugo Site</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 01 Dec 2025 10:14:17 +0000</lastBuildDate>
    <atom:link href="https://cywd123.github.io/tags/%E5%B0%8F%E8%84%9A%E6%9C%AC/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ppt word快速转换PDF小脚本</title>
      <link>https://cywd123.github.io/posts/vhulvqwmjm/</link>
      <pubDate>Mon, 01 Sep 2025 00:11:31 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/vhulvqwmjm/</guid>
      <description>&lt;h2 id=&#34;ppt-word快速转换pdf小脚本&#34;&gt;ppt word快速转换PDF小脚本&lt;/h2&gt;&#xA;&lt;p&gt;这个vbs小脚本可以快速将同一目录下的ppt、pptx、doc、docx文件转换成PDF，即点即用，非常方便。&lt;/p&gt;&#xA;&lt;h3 id=&#34;office----ppt-word快速转换pdf-officevbs-&#34;&gt;Office   （ ppt word快速转换PDF-Office.vbs ）&lt;/h3&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-vbscript&#34; data-lang=&#34;vbscript&#34;&gt;On Error Resume Next&#xD;&#xA;MsgBox &amp;#34;Start converting PPT and Word files into PDF format. Please ensure Office or WPS is installed. Please wait...&amp;#34;, vbInformation, &amp;#34;Conversion Start&amp;#34;&#xD;&#xA;&#xD;&#xA;Const wdExportFormatPDF = 17&#xD;&#xA;Dim oWord, ppt, fso, isOffice, isWPS&#xD;&#xA;&#xD;&#xA;&amp;#39; 初始化变量&#xD;&#xA;Set fso = WScript.CreateObject(&amp;#34;Scripting.Filesystemobject&amp;#34;)&#xD;&#xA;isOffice = False&#xD;&#xA;isWPS = False&#xD;&#xA;&#xD;&#xA;Set oWord = WScript.CreateObject(&amp;#34;KWPS.Application&amp;#34;)&#xD;&#xA;Set ppt = CreateObject(&amp;#34;KWPP.application&amp;#34;)&#xD;&#xA;If IsObject(oWord) And IsObject(ppt) Then&#xD;&#xA;    isOffice = True&#xD;&#xA;Else&#xD;&#xA;    If IsObject(oWord) Then oWord.Quit&#xD;&#xA;    If IsObject(ppt) Then ppt.Quit&#xD;&#xA;    Set oWord = Nothing&#xD;&#xA;    Set ppt = Nothing&#xD;&#xA;    &#xD;&#xA;    Set oWord = WScript.CreateObject(&amp;#34;Word.Application&amp;#34;)&#xD;&#xA;    Set ppt = CreateObject(&amp;#34;PowerPoint.application&amp;#34;)&#xD;&#xA;    If IsObject(oWord) And IsObject(ppt) Then&#xD;&#xA;        isWPS = True&#xD;&#xA;    Else&#xD;&#xA;        &amp;#39; 两种办公软件都未安装&#xD;&#xA;        If IsObject(oWord) Then oWord.Quit&#xD;&#xA;        If IsObject(ppt) Then ppt.Quit&#xD;&#xA;        Set oWord = Nothing&#xD;&#xA;        Set ppt = Nothing&#xD;&#xA;        Set fso = Nothing&#xD;&#xA;        MsgBox &amp;#34;Failed to find Office or WPS. Please install one of them first.&amp;#34;, vbCritical, &amp;#34;Error&amp;#34;&#xD;&#xA;        WScript.Quit&#xD;&#xA;    End If&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;&amp;#39; 开始处理文件夹&#xD;&#xA;ProcessFolder fso.GetFolder(&amp;#34;.&amp;#34;)&#xD;&#xA;&#xD;&#xA;&amp;#39; 清理对象&#xD;&#xA;If IsObject(oWord) Then&#xD;&#xA;    oWord.Quit&#xD;&#xA;    Set oWord = Nothing&#xD;&#xA;End If&#xD;&#xA;If IsObject(ppt) Then&#xD;&#xA;    ppt.Quit&#xD;&#xA;    Set ppt = Nothing&#xD;&#xA;End If&#xD;&#xA;Set fso = Nothing&#xD;&#xA;&#xD;&#xA;MsgBox &amp;#34;PPT and Word files have been successfully converted into PDF format!&amp;#34;, vbInformation, &amp;#34;Conversion Complete&amp;#34;&#xD;&#xA;&#xD;&#xA;Sub ProcessFolder(folder)&#xD;&#xA;    Dim ff, subFolder, pdfPath&#xD;&#xA;    &#xD;&#xA;    For Each ff In folder.Files&#xD;&#xA;        &amp;#39; 处理Word文件 (.doc, .docx) 且不是临时文件&#xD;&#xA;        If (LCase(Right(ff.Name, 4)) = &amp;#34;.doc&amp;#34; Or LCase(Right(ff.Name, 5)) = &amp;#34;.docx&amp;#34;) And Left(ff.Name, 1) &amp;lt;&amp;gt; &amp;#34;~&amp;#34; Then&#xD;&#xA;            pdfPath = Left(ff.Path, InStrRev(ff.Path, &amp;#34;.&amp;#34;)) &amp;amp; &amp;#34;pdf&amp;#34;&#xD;&#xA;            Set oDoc = oWord.Documents.Open(ff.Path)&#xD;&#xA;            oDoc.ExportAsFixedFormat pdfPath, wdExportFormatPDF&#xD;&#xA;            oDoc.Close&#xD;&#xA;            Set oDoc = Nothing&#xD;&#xA;        End If&#xD;&#xA;        &#xD;&#xA;        &amp;#39; 处理PowerPoint文件 (.ppt, .pptx) 且不是临时文件&#xD;&#xA;        If (LCase(Right(ff.Name, 4)) = &amp;#34;.ppt&amp;#34; Or LCase(Right(ff.Name, 5)) = &amp;#34;.pptx&amp;#34;) And Left(ff.Name, 1) &amp;lt;&amp;gt; &amp;#34;~&amp;#34; Then&#xD;&#xA;            pdfPath = Left(ff.Path, InStrRev(ff.Path, &amp;#34;.&amp;#34;)) &amp;amp; &amp;#34;pdf&amp;#34;&#xD;&#xA;            Set pptfile = ppt.Presentations.Open(ff.Path, False, False, False)&#xD;&#xA;            pptfile.SaveAs pdfPath, 32, False&#xD;&#xA;            pptfile.Close&#xD;&#xA;            Set pptfile = Nothing&#xD;&#xA;        End If&#xD;&#xA;    Next&#xD;&#xA;    &#xD;&#xA;    &amp;#39; 递归处理子文件夹&#xD;&#xA;    For Each subFolder In folder.SubFolders&#xD;&#xA;        ProcessFolder subFolder&#xD;&#xA;    Next&#xD;&#xA;End Sub&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;wps---ppt-word快速转换pdf-wpsvbs-&#34;&gt;WPS  ( ppt word快速转换PDF-WPS.vbs )&lt;/h3&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-vbscript&#34; data-lang=&#34;vbscript&#34;&gt;On Error Resume Next&#xD;&#xA;    MsgBox &amp;#34;开始转换PPT和Word文件为PDF格式，请稍候...&amp;#34;&#xD;&#xA;    Const wdExportFormatPDF = 17&#xD;&#xA;    Set oWord = WScript.CreateObject(&amp;#34;KWPS.Application&amp;#34;)&#xD;&#xA;&#x9;Set ppt = CreateObject(&amp;#34;KWPP.application&amp;#34;)&#xD;&#xA;    Set fso = WScript.CreateObject(&amp;#34;Scripting.Filesystemobject&amp;#34;)&#xD;&#xA;    Set fds=fso.GetFolder(&amp;#34;.&amp;#34;)&#xD;&#xA;    Set ffs=fds.Files&#xD;&#xA;&#x9;&#xD;&#xA;    For Each ff In ffs&#xD;&#xA;    If (LCase(Right(ff.Name,4))=&amp;#34;.doc&amp;#34; Or LCase(Right(ff.Name,4))=&amp;#34;docx&amp;#34; ) And Left(ff.Name,1)&amp;lt;&amp;gt;&amp;#34;~&amp;#34; Then&#xD;&#xA;        Set oDoc=oWord.Documents.Open(ff.Path)&#xD;&#xA;        oDoc.ExportAsFixedFormat Left(ff.Path,InStrRev(ff.Path,&amp;#34;.&amp;#34;))&amp;amp;&amp;#34;pdf&amp;#34;,wdExportFormatPDF&#xD;&#xA;        oDoc.Close&#xD;&#xA;&#xD;&#xA;    End If&#xD;&#xA;&#x9;If (LCase(Right(ff.Name,4))=&amp;#34;.ppt&amp;#34; Or LCase(Right(ff.Name,4))=&amp;#34;pptx&amp;#34; ) And Left(ff.Name,1)&amp;lt;&amp;gt;&amp;#34;~&amp;#34; Then&#xD;&#xA;        Set pptfile = ppt.Presentations.Open(ff.Path,false,false,false)&#xD;&#xA;        pptfile.Saveas Left(ff.Path,InStrRev(ff.Path,&amp;#34;.&amp;#34;))&amp;amp;&amp;#34;pdf&amp;#34;,32,false&#xD;&#xA;&#x9;&#x9;pptfile.Close&#xD;&#xA;    End If&#xD;&#xA;    Next&#xD;&#xA;    odoc.Close&#xD;&#xA;    oword.Quit&#xD;&#xA;&#x9;pptfile.Close&#xD;&#xA;&#x9;ppt.Quit&#xD;&#xA;    Set oDoc=Nothing&#xD;&#xA;    Set oWord =Nothing&#xD;&#xA;&#x9;Set pptfile = Nothing&#xD;&#xA;&#x9;Set ppt = Nothing&#xD;&#xA;&#x9;MsgBox &amp;#34;PPT和Word文件已成功转换为PDF格式！&amp;#34;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;合并-ppt-word快速转换pdf-合并vbs&#34;&gt;合并 （ppt word快速转换PDF-合并.vbs）&lt;/h3&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-vbscript&#34; data-lang=&#34;vbscript&#34;&gt;On Error Resume Next&#xD;&#xA;MsgBox &amp;#34;开始转换PPT和Word文件为PDF格式，请稍候...&amp;#34;&#xD;&#xA;Const wdExportFormatPDF = 17&#xD;&#xA;Dim oWord, ppt, isWPS, isOffice&#xD;&#xA;&#xD;&#xA;&amp;#39; 尝试创建WPS对象&#xD;&#xA;Set oWord = WScript.CreateObject(&amp;#34;KWPS.Application&amp;#34;)&#xD;&#xA;Set ppt = CreateObject(&amp;#34;KWPP.Application&amp;#34;)&#xD;&#xA;&#xD;&#xA;&amp;#39; 检测是否是WPS环境&#xD;&#xA;If Not oWord Is Nothing And Not ppt Is Nothing Then&#xD;&#xA;    isWPS = True&#xD;&#xA;Else&#xD;&#xA;    &amp;#39; 尝试创建Office对象&#xD;&#xA;    Set oWord = WScript.CreateObject(&amp;#34;Word.Application&amp;#34;)&#xD;&#xA;    Set ppt = CreateObject(&amp;#34;PowerPoint.Application&amp;#34;)&#xD;&#xA;    If Not oWord Is Nothing And Not ppt Is Nothing Then&#xD;&#xA;        isOffice = True&#xD;&#xA;    Else&#xD;&#xA;        MsgBox &amp;#34;未检测到WPS或Office，请确保已安装其中一款办公软件！&amp;#34;&#xD;&#xA;        WScript.Quit&#xD;&#xA;    End If&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;Set fso = WScript.CreateObject(&amp;#34;Scripting.FileSystemObject&amp;#34;)&#xD;&#xA;Set fds = fso.GetFolder(&amp;#34;.&amp;#34;)&#xD;&#xA;Set ffs = fds.Files&#xD;&#xA;&#xD;&#xA;For Each ff In ffs&#xD;&#xA;    &amp;#39; 处理Word文件&#xD;&#xA;    If (LCase(Right(ff.Name, 4)) = &amp;#34;.doc&amp;#34; Or LCase(Right(ff.Name, 4)) = &amp;#34;docx&amp;#34;) And Left(ff.Name, 1) &amp;lt;&amp;gt; &amp;#34;~&amp;#34; Then&#xD;&#xA;        Set oDoc = oWord.Documents.Open(ff.Path)&#xD;&#xA;        oDoc.ExportAsFixedFormat Left(ff.Path, InStrRev(ff.Path, &amp;#34;.&amp;#34;)) &amp;amp; &amp;#34;pdf&amp;#34;, wdExportFormatPDF&#xD;&#xA;        oDoc.Close&#xD;&#xA;        Set oDoc = Nothing&#xD;&#xA;    End If&#xD;&#xA;    &#xD;&#xA;    &amp;#39; 处理PPT文件&#xD;&#xA;    If (LCase(Right(ff.Name, 4)) = &amp;#34;.ppt&amp;#34; Or LCase(Right(ff.Name, 4)) = &amp;#34;pptx&amp;#34;) And Left(ff.Name, 1) &amp;lt;&amp;gt; &amp;#34;~&amp;#34; Then&#xD;&#xA;        Set pptfile = ppt.Presentations.Open(ff.Path, False, False, False)&#xD;&#xA;        pptfile.SaveAs Left(ff.Path, InStrRev(ff.Path, &amp;#34;.&amp;#34;)) &amp;amp; &amp;#34;pdf&amp;#34;, 32, False&#xD;&#xA;        pptfile.Close&#xD;&#xA;        Set pptfile = Nothing&#xD;&#xA;    End If&#xD;&#xA;Next&#xD;&#xA;&#xD;&#xA;&amp;#39; 清理对象&#xD;&#xA;If Not oWord Is Nothing Then&#xD;&#xA;    oWord.Quit&#xD;&#xA;    Set oWord = Nothing&#xD;&#xA;End If&#xD;&#xA;If Not ppt Is Nothing Then&#xD;&#xA;    ppt.Quit&#xD;&#xA;    Set ppt = Nothing&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;MsgBox &amp;#34;PPT和Word文件已成功转换为PDF格式！&amp;#34;&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>问卷星自动填写脚本</title>
      <link>https://cywd123.github.io/posts/trgcxiotbs/</link>
      <pubDate>Sun, 23 Mar 2025 18:17:36 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/trgcxiotbs/</guid>
      <description>&lt;p&gt;2025年3月23日测试批量填写80份正常。&lt;/p&gt;&#xA;&lt;p&gt;需要模拟鼠标操作防止被识别机器人&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;import re&#xD;&#xA;from playwright.async_api import Playwright, async_playwright&#xD;&#xA;#from playwright.sync_api import Playwright, sync_playwright, expect&#xD;&#xA;import random&#xD;&#xA;&#xD;&#xA;import asyncio&#xD;&#xA;import time&#xD;&#xA;def random_int(min=2, max=4):&#xD;&#xA;    random.seed(time.time())    &#xD;&#xA;    return str(random.randint(min, max))&#xD;&#xA;&#xD;&#xA;async def mouse_random_move(page):&#xD;&#xA;    # 模拟鼠标随机平滑移动&#xD;&#xA;    for i in range(5):&#xD;&#xA;        await page.mouse.move(random.randint(0, 1000), random.randint(0, 1000))&#xD;&#xA;        await asyncio.sleep(0.1)&#xD;&#xA;    # 模拟鼠标随机停留&#xD;&#xA;    #time.sleep(random.randint(0,1))&#xD;&#xA;    # 鼠标滚轮&#xD;&#xA;&#xD;&#xA;async def run(browser) -&amp;gt; None:&#xD;&#xA;    &#xD;&#xA;    context = await browser.new_context()&#xD;&#xA;    page = await context.new_page()&#xD;&#xA;    await page.goto(&amp;#34;https://www.wjx.cn/vm/Q0x3Wuq.aspx&amp;#34;)&#xD;&#xA;    await page.get_by_text(&amp;#34;男&amp;#34;).click()&#xD;&#xA;    await page.get_by_text(&amp;#34;大三&amp;#34;).click()&#xD;&#xA;    await page.get_by_text(&amp;#34;1000-&amp;#34;).click()&#xD;&#xA;    await page.locator(&amp;#34;div&amp;#34;).filter(has_text=re.compile(r&amp;#34;^全部来自家庭部分来自家庭，部分靠自己赚取全部靠自己赚取$&amp;#34;)).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div&amp;#34;).filter(has_text=re.compile(r&amp;#34;^300以下300-600600-10001000以上$&amp;#34;)).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div&amp;#34;).filter(has_text=re.compile(r&amp;#34;^无1-200200-500500以上$&amp;#34;)).get_by_role(&amp;#34;link&amp;#34;).nth(2).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div&amp;#34;).filter(has_text=re.compile(r&amp;#34;^实体店网购$&amp;#34;)).get_by_role(&amp;#34;link&amp;#34;).first.click()&#xD;&#xA;    await page.locator(&amp;#34;div&amp;#34;).filter(has_text=re.compile(r&amp;#34;^100以下100-500500-10001000以上$&amp;#34;)).get_by_role(&amp;#34;link&amp;#34;).nth(3).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div&amp;#34;).filter(has_text=re.compile(r&amp;#34;^无200以下200-500500-10001000以上$&amp;#34;)).get_by_role(&amp;#34;link&amp;#34;).nth(2).click()&#xD;&#xA;    await page.locator(&amp;#34;#div10&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(2).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div11&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div12&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).first.click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div13&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div14&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(2).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div15&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div16&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(2).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div17&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div:nth-child(2) &amp;gt; .jqcheckwrapper &amp;gt; .jqcheck&amp;#34;).first.click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div:nth-child(5) &amp;gt; .jqcheckwrapper &amp;gt; .jqcheck&amp;#34;).first.click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;div:nth-child(7) &amp;gt; .jqcheckwrapper &amp;gt; .jqcheck&amp;#34;).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div19&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(3).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div20&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).nth(1).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div20&amp;#34;).get_by_role(&amp;#34;link&amp;#34;).first.click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div21 &amp;gt; .ui-controlgroup &amp;gt; div:nth-child(2) &amp;gt; .jqcheckwrapper &amp;gt; .jqcheck&amp;#34;).click()&#xD;&#xA;    await mouse_random_move(page)&#xD;&#xA;    await page.locator(&amp;#34;#div21 &amp;gt; .ui-controlgroup &amp;gt; div:nth-child(4) &amp;gt; .jqcheckwrapper &amp;gt; .jqcheck&amp;#34;).click()&#xD;&#xA;    await page.get_by_text(&amp;#34;提交&amp;#34;).click()&#xD;&#xA;    await page.wait_for_function(&amp;#34;window.location.href !== &amp;#39;https://www.wjx.cn/vm/Q0x3Wuq.aspx&amp;#39;&amp;#34;)&#xD;&#xA;    await page.wait_for_timeout(3000)&#xD;&#xA;    await page.close()&#xD;&#xA;    await context.close()&#xD;&#xA;&#xD;&#xA;async def main() -&amp;gt; None:&#xD;&#xA;    async with async_playwright() as p:&#xD;&#xA;        browser = await  p.chromium.launch(headless=True)&#xD;&#xA;        tasks = []&#xD;&#xA;        for i in range(6):&#xD;&#xA;            tasks.append(run(browser))&#xD;&#xA;        titles=await asyncio.gather(*tasks)&#xD;&#xA;        for title in titles:  &#xD;&#xA;            print(title) &#xD;&#xA;        await browser.close()&#xD;&#xA;        &#xD;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xD;&#xA;    asyncio.run(main())&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>cmd 利用curl实现全网卡登录STU校园网</title>
      <link>https://cywd123.github.io/posts/lq1iwgc7e1/</link>
      <pubDate>Mon, 17 Mar 2025 12:38:48 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/lq1iwgc7e1/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&#xD;&#xA;@echo off&#xD;&#xA;for /f &amp;#34;tokens=*&amp;#34; %%i in (&#xD;&#xA;    &amp;#39;powershell -Command &amp;#34;Get-NetIPAddress | Where-Object {$_.AddressFamily -eq &amp;#39;IPv4&amp;#39; -and $_.IPAddress -ne &amp;#39;127.0.0.1&amp;#39;} | Select-Object -ExpandProperty IPAddress&amp;#34;&amp;#39;&#xD;&#xA;) do (&#xD;&#xA;    echo 发现有效IP: %%i&#xD;&#xA;    curl --data &amp;#34;opr=pwdLogin&amp;amp;userName=账号&amp;amp;pwd=密码&amp;amp;rememberPwd=1&amp;#34; http://1.1.1.2/ac_portal/login.php --interface %%i&#xD;&#xA;)&#xD;&#xA;pause&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>EndNote/Zotero批量添加PubMed文献脚本</title>
      <link>https://cywd123.github.io/posts/7uduxw77v6/</link>
      <pubDate>Fri, 14 Mar 2025 21:10:48 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/7uduxw77v6/</guid>
      <description>&lt;p&gt;代理使用8089端口，适配clash&lt;br&gt;&#xA;使用：同目录下创建paper.txt，一行一个填写一个PMID&lt;br&gt;&#xA;生成一个citation.nbib格式的文件&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&#xA;# %%&#xA;###预处理，先把文章全部复制到一个paper.txt文本中&#xA;###先获取所有PMID: 后面的数字&#xA;import re&#xA;import pandas as pd&#xA;import numpy as np&#xA;&#xA;proxies = {&amp;#34;http&amp;#34;: &amp;#34;http://127.0.0.1:8089&amp;#34;}&#xA;&#xA;pm=pd.read_csv(&amp;#39;paper.txt&amp;#39;,header=None)&#xA;# to list&#xA;pm=pm[0].tolist()&#xA;&#xA;&#xA;# %%&#xA;import requests&#xA;from concurrent.futures import ThreadPoolExecutor&#xA;&#xA;def fetch_pmid(pmid):&#xA;    max_retries = 300  # 设置最大重试次数&#xA;    for attempt in range(max_retries):&#xA;        url = &amp;#39;https://api.ncbi.nlm.nih.gov/lit/ctxp/v1/pubmed/?format=medline&amp;amp;id={}&amp;#39;.format(pmid)&#xA;        print(url)&#xA;        print(&amp;#34;-------requests start--------------&amp;#34;)&#xA;        res = requests.get(url,proxies=proxies)&#xA;        print(&amp;#34;-------requests end--------------&amp;#34;)&#xA;        print(res)&#xA;        if res.status_code == 200:&#xA;            res.close()&#xA;            return res.text + &amp;#34;\n&amp;#34;&#xA;&#xA;        else:&#xA;            print(f&amp;#34;Request failed, retrying... (attempt {attempt + 1}/{max_retries})&amp;#34;)&#xA;    &#xA;    print(f&amp;#34;Failed to fetch PMID {pmid} after {max_retries} attempts.&amp;#34;)&#xA;    return &amp;#34;&amp;#34;&#xA;&#xA;cita = []&#xA;&#xA;# 设置线程数，这里设置为4，你可以根据需要调整&#xA;num_threads = 32&#xA;&#xA;with ThreadPoolExecutor(max_workers=num_threads) as executor:&#xA;    # 使用多线程并行处理每个pmid&#xA;    results = list(executor.map(fetch_pmid, pm))&#xA;&#xA;cita.extend(results)&#xA;&#xA;# 替换处理&#xA;&#xA;# %%&#xA;cita = [y.replace(&amp;#34;\r&amp;#34;, &amp;#34;&amp;#34;) for y in cita]&#xA;cita = [y + &amp;#34;\n&amp;#34; for y in cita]&#xA;f=open(&amp;#34;citation.nbib&amp;#34;,&amp;#34;w&amp;#34;,encoding=&amp;#39;utf-8&amp;#39;)&#xA;f.writelines(cita)&#xA;f.close()&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>使用Hyper-V配置网卡多个虚拟网卡</title>
      <link>https://cywd123.github.io/posts/kbg4hlog6b/</link>
      <pubDate>Fri, 14 Mar 2025 20:55:35 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/kbg4hlog6b/</guid>
      <description>&lt;h2 id=&#34;配置-hyper-v&#34;&gt;配置 Hyper-V&lt;/h2&gt;&#xA;&lt;p&gt;首先需要启用 Hyper-V，在 &lt;strong&gt;管理员 Powershell&lt;/strong&gt;输入以下命令：&lt;/p&gt;&#xA;&lt;p&gt;然后重启电脑。&lt;/p&gt;&#xA;&lt;h3 id=&#34;启用-hyper-v&#34;&gt;启用 Hyper-V&lt;/h3&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;安装-hyper-v-虚拟交换机&#34;&gt;安装 Hyper-V 虚拟交换机&lt;/h3&gt;&#xA;&lt;p&gt;在管理员 Powershell 输入以下命令。name 参数后面的 Ethernet-Virt 是虚拟交换机的名称，可以任取。 NetAdapterName 参数后面的 Ethernet 代表你要桥接的物理网卡的名称，中文版系统一般为 以太网，英文版为 Ethernet。注意 AllowManagementOS 需要为 $false，否则 Hyper-V 会创建一个和物理网卡一样 MAC 地址的虚拟网卡妨碍我们使用。&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;New-VMSwitch -name Ethernet-Virt -AllowManagementOS $false  -NetAdapterName &amp;#34;以太网 2&amp;#34;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;向宿主机添加虚拟网卡&#34;&gt;向宿主机添加虚拟网卡&lt;/h3&gt;&#xA;&lt;p&gt;在管理员 Powershell 输入以下命令。Switch 参数后面的 Ethernet-Virt 是虚拟交换机的名称。 Name 参数后面的 Ethernet-Virt-Main 是虚拟网卡的名称，可以任取。注意要有 ManagementOS 参数，代表向宿主机添加网卡而不是某个虚拟机。StaticMacAddress 后面的 e0-00-00-00-ca-01 是虚拟网卡的 MAC 地址，可以任取，但必须唯一并且是单播地址（不懂单播、多播地址的话就无脑e0开头，然后后面的数字随便换）。&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main1&amp;#34; -StaticMacAddress 38:fd:cc:7c:94:c5&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main2&amp;#34; -StaticMacAddress b0:36:c6:fa:f4:df&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main3&amp;#34; -StaticMacAddress 90:53:84:3e:9b:12&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main4&amp;#34; -StaticMacAddress 5c:1f:4b:eb:62:ad&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main5&amp;#34; -StaticMacAddress 58:d3:b1:6b:f4:97&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main6&amp;#34; -StaticMacAddress 18:9c:1a:d5:ca:a8&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main7&amp;#34; -StaticMacAddress 54:7c:bd:16:ae:0a&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main8&amp;#34; -StaticMacAddress d0:7c:6b:78:13:2f&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main9&amp;#34; -StaticMacAddress a0:05:1c:48:0b:12&#xD;&#xA;Add-VMNetworkAdapter -Switch Ethernet-Virt -ManagementOS -Name &amp;#34;Ethernet-Virt-Main10&amp;#34; -StaticMacAddress ec:89:10:ac:20:97&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;使用结束删除虚拟交换机-confirm--a&#34;&gt;使用结束，删除虚拟交换机： Confirm : A&lt;/h3&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Remove-VMSwitch -name Ethernet-Virt -Force -Confirm&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>python 利用curl将全部网卡适配器登录STU校园网</title>
      <link>https://cywd123.github.io/posts/byprsldhih/</link>
      <pubDate>Fri, 14 Mar 2025 20:49:01 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/byprsldhih/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;import netifaces&#xD;&#xA;import os&#xD;&#xA;# 获取所有网络接口&#xD;&#xA;interfaces = netifaces.interfaces()&#xD;&#xA;&#xD;&#xA;for iface in interfaces:&#xD;&#xA;    # 获取接口的地址信息&#xD;&#xA;    addresses = netifaces.ifaddresses(iface)&#xD;&#xA;    # 提取 IPv4 地址&#xD;&#xA;    if netifaces.AF_INET in addresses:&#xD;&#xA;        for addr_info in addresses[netifaces.AF_INET]:&#xD;&#xA;            ip = addr_info.get(&amp;#39;addr&amp;#39;)&#xD;&#xA;            if ip:&#xD;&#xA;                print(f&amp;#34;适配器 {iface} 的IP地址: {ip}&amp;#34;)&#xD;&#xA;                os.system(&amp;#39;curl --data &amp;#34;opr=pwdLogin&amp;amp;userName=账号&amp;amp;pwd=密码&amp;amp;rememberPwd=1&amp;#34; http://1.1.1.2/ac_portal/login.php  --interface &amp;#39; + ip)&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>ECDSA实例</title>
      <link>https://cywd123.github.io/posts/22bskm0nwq/</link>
      <pubDate>Tue, 11 Mar 2025 01:05:02 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/22bskm0nwq/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&#xD;&#xA;import os&#xD;&#xA;import ecdsa&#xD;&#xA;&#xD;&#xA;# 生成私钥和公钥&#xD;&#xA;def generate_keys():&#xD;&#xA;    # 使用secp256k1曲线生成密钥对&#xD;&#xA;    sk = ecdsa.SigningKey.generate(curve=ecdsa.SECP256k1)&#xD;&#xA;    vk = sk.get_verifying_key()&#xD;&#xA;    return sk, vk&#xD;&#xA;&#xD;&#xA;# 对消息进行签名&#xD;&#xA;def sign_message(private_key, message):&#xD;&#xA;    return private_key.sign(message)&#xD;&#xA;&#xD;&#xA;# 验证签名&#xD;&#xA;def verify_signature(public_key, message, signature):&#xD;&#xA;    return public_key.verify(signature, message)&#xD;&#xA;&#xD;&#xA;# %%&#xD;&#xA;private_key, public_key = generate_keys()&#xD;&#xA;# 简单消息&#xD;&#xA;message = b&amp;#34;Hello, ECDSA!&amp;#34;&#xD;&#xA;&#xD;&#xA;# 签名消息&#xD;&#xA;signature = sign_message(private_key, message)&#xD;&#xA;print(f&amp;#34;Signature: {signature.hex()}&amp;#34;)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;# %% &#xD;&#xA;sig=&amp;#39;adee313bebf78c1bd4a9719e0ad9aa871ff8195788ad2d7510f35e1ef0ce00a6cbfea518e4ea1716a729c7313a52da8b0c57ff0e0f97251ea604beef3890f699&amp;#39;&#xD;&#xA;message = b&amp;#34;Hello, ECDSA!&amp;#34;&#xD;&#xA;signature = bytes.fromhex(sig)&#xD;&#xA;print(verify_signature(public_key, message, signature))   #验证签名&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>STU校园网自动登录脚本</title>
      <link>https://cywd123.github.io/posts/htt13gbuie/</link>
      <pubDate>Tue, 11 Mar 2025 00:52:49 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/htt13gbuie/</guid>
      <description>&lt;p&gt;cmd, ???处分别改称用户名和校园网密码&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&#xD;&#xA;@ECHO OFF&#xD;&#xA;REM 启动延时变量&#xD;&#xA;setlocal enabledelayedexpansion&#xD;&#xA;:LoginCheck&#xD;&#xA;for /F %%i in ( &amp;#39;curl -I -m 10 -o /dev/null -s -w %%{http_code} www.baidu.com&amp;#39; ) do ( set http_code=%%i )&#xD;&#xA;if /i %http_code% neq 200 (&#xD;&#xA;&#x9;curl --data &amp;#34;opr=pwdLogin&amp;amp;userName=???&amp;amp;pwd=???&amp;amp;rememberPwd=1&amp;#34; http://1.1.1.2/ac_portal/login.php&amp;gt;result.txt&#x9;&#xD;&#xA;&#x9;set /p result=&amp;lt;result.txt&#xD;&#xA;&#x9;set result=!result:~11,4!&#xD;&#xA;&#x9;if !result! equ true (&#xD;&#xA;&#x9;&#x9;echo Login Success&#xD;&#xA;&#x9;) else (&#xD;&#xA;&#x9;&#x9;echo Login Failed, Try Again&#xD;&#xA;&#x9;&#x9;choice /t 10 /d y /n &amp;gt;nul&#xD;&#xA;&#x9;&#x9;goto LoginCheck&#xD;&#xA;&#x9;)&#xD;&#xA;&#x9;del result.txt&#xD;&#xA;)&#xD;&#xA;endlocal&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>vbs脚本 快速将ppt word文档转换成pdf</title>
      <link>https://cywd123.github.io/posts/92gfku-5zk/</link>
      <pubDate>Tue, 11 Mar 2025 00:48:44 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/92gfku-5zk/</guid>
      <description>&lt;p&gt;保存为vbs脚本，可以将同目录下的ppt、word转成PDF，非常方便&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;On Error Resume Next&#xA;    Const wdExportFormatPDF = 17&#xA;    Set oWord = WScript.CreateObject(&amp;#34;Word.Application&amp;#34;)&#xA;&#x9;Set ppt = CreateObject(&amp;#34;PowerPoint.application&amp;#34;)&#xA;    Set fso = WScript.CreateObject(&amp;#34;Scripting.Filesystemobject&amp;#34;)&#xA;    Set fds=fso.GetFolder(&amp;#34;.&amp;#34;)&#xA;    Set ffs=fds.Files&#xA;&#x9;&#xA;    For Each ff In ffs&#xA;    If (LCase(Right(ff.Name,4))=&amp;#34;.doc&amp;#34; Or LCase(Right(ff.Name,4))=&amp;#34;docx&amp;#34; ) And Left(ff.Name,1)&amp;lt;&amp;gt;&amp;#34;~&amp;#34; Then&#xA;        Set oDoc=oWord.Documents.Open(ff.Path)&#xA;        odoc.ExportAsFixedFormat Left(ff.Path,InStrRev(ff.Path,&amp;#34;.&amp;#34;))&amp;amp;&amp;#34;pdf&amp;#34;,wdExportFormatPDF&#xA;    End If&#xA;&#x9;If (LCase(Right(ff.Name,4))=&amp;#34;.ppt&amp;#34; Or LCase(Right(ff.Name,4))=&amp;#34;pptx&amp;#34; ) And Left(ff.Name,1)&amp;lt;&amp;gt;&amp;#34;~&amp;#34; Then&#xA;Set pptfile = ppt.Presentations.Open(ff.Path,false,false,false)&#xA;pptfile.Saveas Left(ff.Path,InStrRev(ff.Path,&amp;#34;.&amp;#34;))&amp;amp;&amp;#34;pdf&amp;#34;,32,false&#xA;End If&#xA;    Next&#xA;    odoc.Close&#xA;    oword.Quit&#xA;&#x9;pptfiles.Close&#xA;&#x9;ppt.Quit&#xA;    Set oDoc=Nothing&#xA;    Set oWord =Nothing&#xA;&#x9;Set pptfile = Nothing&#xA;&#x9;Set ppt = Nothing&#xA;&#x9;MsgBox &amp;#34;PPT和Word全部转换为PDF啦!&amp;#34;&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>雨课堂习题监控</title>
      <link>https://cywd123.github.io/posts/pbdbfbga9g/</link>
      <pubDate>Tue, 11 Mar 2025 00:41:06 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/pbdbfbga9g/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;原理：雨课堂每次切换PPT时url也会跟着改变。在检测到ppt切换后，获取ppt的图片，并且进行OCR检测，如果出现‘单选’、‘多选’、‘判断’、‘填空’、‘投票’等词汇，就认定该ppt是习题，就会发出警告提醒。&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用前需要配置state.json保存登录记录。&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;import asyncio&#xD;&#xA;from playwright.async_api import async_playwright&#xD;&#xA;import requests&#xD;&#xA;import threading&#xD;&#xA;import winsound&#xD;&#xA;from plyer import notification&#xD;&#xA;import easyocr&#xD;&#xA;url=&amp;#34;&amp;#34;&#xD;&#xA;# 初始化 EasyOCR&#xD;&#xA;reader = easyocr.Reader([&amp;#39;ch_sim&amp;#39;, &amp;#39;en&amp;#39;])&#xD;&#xA;&#xD;&#xA;async def notice_ti(page):&#xD;&#xA;    # 尝试查找图片元素&#xD;&#xA;    elementimg = await page.query_selector_all(&amp;#39;//*[@id=&amp;#34;app&amp;#34;]/section/section[1]/section[2]/section/section/section/section[1]/section/div/section/section/img&amp;#39;)&#xD;&#xA;    if len(elementimg) == 0:&#xD;&#xA;        elementimg = await page.query_selector_all(&amp;#39;//*[@id=&amp;#34;app&amp;#34;]/section/section[1]/section[2]/section/section/section/section[1]/section/section/section/section/img&amp;#39;)&#xD;&#xA;&#xD;&#xA;    # 发送新页面通知&#xD;&#xA;    notification.notify(title=&amp;#39;新的一页&amp;#39;, message=&amp;#39;新的一页&amp;#39;, app_icon=None, timeout=0.5)&#xD;&#xA;&#xD;&#xA;    if elementimg:&#xD;&#xA;        # 获取图片地址&#xD;&#xA;        img_url = await elementimg[0].get_attribute(&amp;#39;src&amp;#39;)&#xD;&#xA;        # 直接下载图片&#xD;&#xA;        tmp = requests.get(img_url)&#xD;&#xA;        with open(&amp;#39;tmp.png&amp;#39;, &amp;#39;wb&amp;#39;) as f:&#xD;&#xA;            f.write(tmp.content)&#xD;&#xA;&#xD;&#xA;        # 使用 EasyOCR 识别图片文字&#xD;&#xA;        result = reader.readtext(&amp;#39;tmp.png&amp;#39;)&#xD;&#xA;        # 如果 result 中含有‘单选’、‘多选’、‘判断’、‘填空’、‘投票’、‘问答’、‘作业’、‘讨论’、‘实验’、‘课件’、‘课程’、‘提交’等关键词，就发送通知&#xD;&#xA;        keywords = [&amp;#39;单选&amp;#39;, &amp;#39;多选&amp;#39;, &amp;#39;判断&amp;#39;, &amp;#39;填空&amp;#39;, &amp;#39;投票&amp;#39;, &amp;#39;问答&amp;#39;, &amp;#39;作业&amp;#39;, &amp;#39;讨论&amp;#39;, &amp;#39;实验&amp;#39;, &amp;#39;提交&amp;#39;]&#xD;&#xA;        #keywords = [&amp;#39;电解&amp;#39;]&#xD;&#xA;        if any(x in str(result) for x in keywords):&#xD;&#xA;            print(img_url)&#xD;&#xA;            threading.Thread(target=lambda: winsound.Beep(440, 3000)).start()&#xD;&#xA;            notification.notify(title=&amp;#39;有题！&amp;#39;, message=&amp;#39;有题！&amp;#39;, app_icon=None, timeout=0.5)&#xD;&#xA;            # ai(result)&#xD;&#xA;            # clear_page()&#xD;&#xA;&#xD;&#xA;async def main():&#xD;&#xA;    async with async_playwright() as p:&#xD;&#xA;        # 配置浏览器选项&#xD;&#xA;        browser = await p.chromium.launch(headless=True)&#xD;&#xA;        context = await browser.new_context(storage_state=&amp;#39;state.json&amp;#39;)&#xD;&#xA;        page = await context.new_page()&#xD;&#xA;        # 打开指定页面&#xD;&#xA;        await page.goto(url)&#xD;&#xA;&#xD;&#xA;        current_url = page.url&#xD;&#xA;        while True:&#xD;&#xA;            # 等待 URL 变化&#xD;&#xA;            await page.wait_for_url(lambda url: url != current_url, timeout=10000000)&#xD;&#xA;            current_url = page.url&#xD;&#xA;            await notice_ti(page)&#xD;&#xA;            #await print(&amp;#34;已到达新页面&amp;#34;)&#xD;&#xA;&#xD;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xD;&#xA;    url=input(&amp;#34;请输入网址：&amp;#34;)&#xD;&#xA;    asyncio.run(main())&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
  </channel>
</rss>
