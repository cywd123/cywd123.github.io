<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>分子对接 on Juiceright</title>
    <link>https://cywd123.github.io/tags/%E5%88%86%E5%AD%90%E5%AF%B9%E6%8E%A5/</link>
    <description>Recent content in 分子对接 on Juiceright</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 01 Dec 2025 09:31:17 +0000</lastBuildDate>
    <atom:link href="https://cywd123.github.io/tags/%E5%88%86%E5%AD%90%E5%AF%B9%E6%8E%A5/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>【分子对接】2. 利用pymol下载蛋白质 脚本</title>
      <link>https://cywd123.github.io/posts/ysld_6qj2a/</link>
      <pubDate>Wed, 26 Mar 2025 20:28:24 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/ysld_6qj2a/</guid>
      <description>&lt;p&gt;下载蛋白质，去除水分子，加H，去除配体，去除副链&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&#xD;&#xA;# %%&#xD;&#xA;import pymol&#xD;&#xA;&#xD;&#xA;# %%&#xD;&#xA;# 使用 fetch 指令获取蛋白质结构，这里以 4FAA 为例&#xD;&#xA;pdb_id = &amp;#39;4FAA&amp;#39;&#xD;&#xA;pymol.cmd.fetch(pdb_id)&#xD;&#xA;&#xD;&#xA;# 去除水分子&#xD;&#xA;pymol.cmd.remove(&amp;#39;solvent&amp;#39;)&#xD;&#xA;&#xD;&#xA;# 加 H（氢原子）&#xD;&#xA;pymol.cmd.h_add()&#xD;&#xA;&#xD;&#xA;# 选择配体（这里假设配体残基名为 NAG）&#xD;&#xA;pymol.cmd.select(&amp;#39;ligand&amp;#39;, &amp;#39;resn NAG&amp;#39;)&#xD;&#xA;&#xD;&#xA;# 去除配体&#xD;&#xA;pymol.cmd.remove(&amp;#39;ligand&amp;#39;)&#xD;&#xA;&#xD;&#xA;# 显示链 A 的信息&#xD;&#xA;pymol.cmd.iterate(&amp;#39;chain A&amp;#39;, &amp;#39;print(resi, resn)&amp;#39;)&#xD;&#xA;&#xD;&#xA;# 去除副链（只保留主链）&#xD;&#xA;pymol.cmd.remove(&amp;#39;sidechain&amp;#39;)&#xD;&#xA;&#xD;&#xA;# 导出结果为 PDB 文件&#xD;&#xA;output_file = f&amp;#39;{pdb_id}.pymol.pdb&amp;#39;&#xD;&#xA;pymol.cmd.save(output_file)&#xD;&#xA;&#xD;&#xA;# 退出 PyMOL&#xD;&#xA;pymol.cmd.quit()&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>【分子对接】1. 自动从pubchem下载小分子 脚本</title>
      <link>https://cywd123.github.io/posts/qin3ksdr8z/</link>
      <pubDate>Wed, 26 Mar 2025 20:25:40 +0000</pubDate>
      <guid>https://cywd123.github.io/posts/qin3ksdr8z/</guid>
      <description>&lt;p&gt;本代码用于从pubchem下载小分子(阿司匹林)，并且自动转换成pymol的pdb格式&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;import pubchempy as pcp&#xD;&#xA;from pymol import cmd&#xD;&#xA;import os&#xD;&#xA;def download_sdf(compound_identifier, output_file):&#xD;&#xA;    try:&#xD;&#xA;        # 尝试根据标识符获取化合物&#xD;&#xA;        if isinstance(compound_identifier, int):&#xD;&#xA;            compound = pcp.Compound.from_cid(compound_identifier)&#xD;&#xA;        else:&#xD;&#xA;            results = pcp.get_compounds(compound_identifier, &amp;#39;name&amp;#39;)&#xD;&#xA;            if results:&#xD;&#xA;                compound = results[0]&#xD;&#xA;            else:&#xD;&#xA;                print(f&amp;#34;未找到与 {compound_identifier} 匹配的化合物。&amp;#34;)&#xD;&#xA;                return&#xD;&#xA;&#xD;&#xA;        # 下载 SDF 文件&#xD;&#xA;        sdf_content = compound.canonical_smiles&#xD;&#xA;        sdf = pcp.get_sdf(compound.cid)&#xD;&#xA;        with open(output_file, &amp;#39;w&amp;#39;) as file:&#xD;&#xA;            file.write(sdf)&#xD;&#xA;        print(f&amp;#34;SDF 文件已成功保存到 {output_file}&amp;#34;)&#xD;&#xA;    except Exception as e:&#xD;&#xA;        print(f&amp;#34;下载过程中出现错误: {e}&amp;#34;)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xD;&#xA;    # 这里可以替换为你想要查询的化合物名称或 CID&#xD;&#xA;    compound_identifier = &amp;#34;aspirin&amp;#34;&#xD;&#xA;    output_file = compound_identifier + &amp;#34;.sdf&amp;#34;&#xD;&#xA;    download_sdf(compound_identifier, output_file)&#xD;&#xA;    # 使用 PyMOL 加载 SDF 文件并进行后续处理&#xD;&#xA;    cmd.load(output_file)&#xD;&#xA;    # 保存为 PDB 文件（可选）&#xD;&#xA;    cmd.save(compound_identifier + &amp;#34;.pdb&amp;#34;, state=0)&#xD;&#xA;    cmd.quit()&#xD;&#xA;    # 删除临时 SDF 文件（可选）&#xD;&#xA;    #os.remove(output_file)&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
  </channel>
</rss>
